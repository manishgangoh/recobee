<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Box Office Dashboard - Dark Theme</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.dataTables.min.css" />
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
    <style>
        :root {
            --bg-dark: #121212;
            --bg-card: #1E1E1E;
            --text-white: #FFFFFF;
            --text-yellow: #FFD700;
            --accent-yellow: #FFD700;
            --accent-dark-yellow: #FFC000;
            --border-color: #333333;
            --chart-grid: #333333;
            --chart-text: #CCCCCC;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--bg-dark);
            color: var(--text-white);
            padding: 20px;
        }
        
        .dashboard {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .dashboard-title {
            font-size: 28px;
            font-weight: 600;
            color: var(--text-white);
        }
        
        .dashboard-update {
            color: var(--text-yellow);
            font-size: 14px;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 20px;
        }
        
        .card {
            background-color: var(--bg-card);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
        }
        
        .card-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-white);
        }
        
        .card-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 6px 12px;
            border-radius: 4px;
            border: 1px solid var(--accent-yellow);
            background-color: transparent;
            color: var(--accent-yellow);
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            background-color: var(--accent-yellow);
            color: var(--bg-dark);
        }
        
        .btn-primary {
            background-color: var(--accent-yellow);
            color: var(--bg-dark);
            border-color: var(--accent-yellow);
        }
        
        .btn-primary:hover {
            background-color: var(--accent-dark-yellow);
            border-color: var(--accent-dark-yellow);
        }
        
        .overview-panel {
            grid-column: span 4;
        }
        
        .total-box-office {
            font-size: 32px;
            font-weight: 600;
            margin: 15px 0;
            color: var(--accent-yellow);
        }
        
        .day-wise-collection {
            grid-column: span 8;
        }
        
        .chart-container {
            height: 250px;
            margin-top: 20px;
            position: relative;
        }
        
        .heatmap {
            grid-column: span 6;
        }
        
        .hourly-trend {
            grid-column: span 6;
        }
        
        .revenue-by-city {
            grid-column: span 4;
        }
        
        .occupancy {
            grid-column: span 4;
        }
        
        .top-cities {
            grid-column: span 4;
        }
        
        .theatre-data {
            grid-column: span 12;
        }
        
        .pricing-insights {
            grid-column: span 12;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-white);
        }
        
        th {
            background-color: rgba(255, 215, 0, 0.1);
            font-weight: 600;
            color: var(--accent-yellow);
        }
        
        tr:hover {
            background-color: rgba(255, 215, 0, 0.05);
        }
        
        .filters {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .filter-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
            flex-grow: 1;
        }
        
        .filter-item label {
            font-size: 12px;
            color: var(--text-yellow);
        }
        
        select, input {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background-color: var(--bg-dark);
            color: var(--text-white);
        }
        
        select:focus, input:focus {
            outline: none;
            border-color: var(--accent-yellow);
        }
        
        .progress-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .progress-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .progress-label {
            width: 100px;
            font-size: 14px;
            color: var(--text-white);
        }
        
        .progress-bar {
            flex-grow: 1;
            height: 20px;
            background-color: var(--border-color);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background-color: var(--accent-yellow);
        }
        
        .city-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid var(--border-color);
        }
        
        .city-item:last-child {
            border-bottom: none;
        }
        
        .pricing-grid {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 20px;
            margin-top: 20px;
        }
        
        .pricing-card {
            background: none;
            border: none;
            box-shadow: none;
            padding: 0;
            text-align: center;
        }
        
        .circle-chart-container {
            position: relative;
            width: 80px;
            height: 80px;
            margin: 0 auto 8px auto;
        }
        
        .circle-chart-value {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 22px;
            font-weight: 600;
            color: #222;
            pointer-events: none;
        }
        
        .circle-chart-value.economy { color: #FFD700; }
        .circle-chart-value.gold { color: #FFC000; }
        .circle-chart-value.vip { color: #FFA500; }
        
        .pricing-label {
            font-size: 15px;
            color: #222;
            margin-top: 4px;
        }
        
        .economy {
            color: var(--accent-yellow);
        }
        
        .gold {
            color: #FFC000;
        }
        
        .vip {
            color: #FFA500;
        }
        
        @media (max-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: repeat(6, 1fr);
            }
            
            .overview-panel, .revenue-by-city, .occupancy, .top-cities {
                grid-column: span 3;
            }
            
            .day-wise-collection, .heatmap, .hourly-trend {
                grid-column: span 6;
            }
        }
        
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .overview-panel, .revenue-by-city, .occupancy, .top-cities,
            .day-wise-collection, .heatmap, .hourly-trend {
                grid-column: span 2;
            }
            
            .filters {
                flex-direction: column;
            }
        }
        .alerts-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin: 18px 0 0 0;
        }
        .alert-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 6px;
            font-size: 15px;
            background: #181818;
            color: var(--text-white);
            border-left: 4px solid var(--accent-yellow);
            box-shadow: 0 2px 8px rgba(0,0,0,0.12);
        }
        .alert-icon {
            font-size: 20px;
        }
        .alert-high { border-left-color: #00e676; }
        .alert-low { border-left-color: #FF6B6B; }
        .alert-cancel { border-left-color: #FF1744; }
        .alert-high .alert-icon { color: #00e676; }
        .alert-low .alert-icon { color: #FF6B6B; }
        .alert-cancel .alert-icon { color: #FF1744; }
        .city-link {
            color: var(--accent-yellow);
            cursor: pointer;
            text-decoration: underline;
        }
        .city-link:hover {
            color: var(--accent-dark-yellow);
        }
        .drilldown-modal {
            position: fixed;
            z-index: 9999;
            left: 0; top: 0; width: 100vw; height: 100vh;
            background: rgba(0,0,0,0.7);
            display: flex; align-items: center; justify-content: center;
        }
        .drilldown-modal-content {
            background: #181818;
            color: var(--text-white);
            border-radius: 10px;
            padding: 32px 28px 24px 28px;
            min-width: 340px;
            max-width: 95vw;
            box-shadow: 0 8px 32px rgba(0,0,0,0.4);
            position: relative;
        }
        .drilldown-modal-close {
            position: absolute;
            top: 12px; right: 18px;
            font-size: 28px;
            color: var(--accent-yellow);
            cursor: pointer;
        }
        .drilldown-modal-content h2 {
            color: var(--text-white);
            font-size: 22px;
            margin-bottom: 18px;
        }
        .drilldown-modal-content table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 18px;
        }
        .drilldown-modal-content th, .drilldown-modal-content td {
            padding: 10px 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-white);
        }
        .drilldown-modal-content th {
            color: var(--accent-yellow);
            background: rgba(255,215,0,0.07);
        }
        .theatre-link {
            color: #00bcd4;
            cursor: pointer;
            text-decoration: underline;
        }
        .theatre-link:hover {
            color: #FFD700;
        }
        .show-link {
            color: #FFC000;
            cursor: pointer;
            text-decoration: underline;
        }
        .show-link:hover {
            color: #FFD700;
        }
        .seat-pie-container {
            width: 220px; margin: 0 auto 12px auto;
        }
        .section-title {
            color: var(--text-white);
            font-size: 2rem;
            font-weight: 700;
            margin: 40px 0 24px 0;
            letter-spacing: 0.5px;
        }
        .section-subtitle {
            color: var(--text-yellow);
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 18px;
        }
        .summary-row {
            display: flex;
            gap: 32px;
            margin: 40px 0 32px 0;
            justify-content: center;
        }
        .summary-card {
            background: #1E1E1E;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.18);
            padding: 32px 28px 24px 28px;
            min-width: 300px;
            flex: 1 1 0;
            max-width: 400px;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            border: 1px solid var(--border-color);
        }
        .summary-card h3 {
            color: #fff;
            font-size: 1.18rem;
            font-weight: 700;
            margin-bottom: 18px;
            letter-spacing: 0.2px;
        }
        .summary-table {
            width: 100%;
            border-collapse: collapse;
        }
        .summary-table td, .summary-table th {
            padding: 10px 0;
            color: #fff;
            font-size: 1rem;
        }
        .summary-table th {
            font-weight: 600;
            color: #fff;
        }
        .summary-table td.value {
            color: var(--accent-yellow);
            font-weight: 600;
            text-align: right;
        }
        .summary-center-value {
            color: var(--accent-yellow);
            font-size: 2.6rem;
            font-weight: 700;
            text-align: center;
            margin: 18px 0 8px 0;
            width: 100%;
        }
        .summary-center-subtext {
            color: var(--accent-yellow);
            font-size: 1.1rem;
            text-align: center;
            width: 100%;
        }
        @media (max-width: 1100px) {
            .summary-row { flex-direction: column; gap: 18px; }
            .summary-card { max-width: 100%; min-width: 0; align-items: stretch; }
        }
    </style>
    <style>
        table.dataTable {
            background: var(--bg-card);
            color: var(--text-white);
        }
        table.dataTable thead th {
            background: rgba(255,255,255,0.05);
            color: var(--text-white);
            border-bottom: 2px solid var(--accent-yellow);
        }
        table.dataTable tbody td {
            color: var(--text-white);
        }
        .dataTables_wrapper .dataTables_filter input {
            background: var(--bg-dark);
            color: var(--text-white);
            border: 1px solid var(--accent-yellow);
        }
        .dataTables_wrapper .dataTables_paginate .paginate_button {
            background: var(--bg-dark);
            color: var(--accent-yellow) !important;
            border: 1px solid var(--accent-yellow);
            border-radius: 4px;
            margin: 0 2px;
        }
        .dataTables_wrapper .dataTables_paginate .paginate_button.current {
            background: var(--accent-yellow) !important;
            color: var(--bg-dark) !important;
        }
        .dt-button.btn.btn-primary {
            background: var(--accent-yellow);
            color: var(--bg-dark);
            border: 1px solid var(--accent-yellow);
            border-radius: 4px;
            margin-right: 8px;
            font-size: 12px;
        }
        .dt-button.btn.btn-primary:hover {
            background: var(--accent-dark-yellow);
            color: var(--bg-dark);
            border-color: var(--accent-dark-yellow);
        }
        .comparison-panel .filters {
            margin-bottom: 0;
        }
        .comparison-panel .filter-item label {
            color: var(--text-yellow);
        }
        .comparison-panel select {
            background: var(--bg-dark);
            color: var(--text-white);
            border: 1px solid var(--accent-yellow);
        }
    </style>
</head>
<body style="background:#111; color:#fff; font-family:'Segoe UI',sans-serif;">
<div style="max-width:1600px;margin:0 auto;padding:32px 0;">
  <h2 style="font-size:1.2rem;font-weight:600;margin-bottom:24px;letter-spacing:0.5px;">BoxOffice Insights</h2>
  <!-- Summary Cards -->
  <div style="display:flex;gap:24px;margin-bottom:32px;">
    <div style="flex:1;background:#181818;border-radius:14px;padding:24px 0 18px 24px;display:flex;flex-direction:column;gap:8px;min-width:180px;">
      <div style="font-size:0.95rem;color:#aaa;">Net Collection</div>
      <div style="font-size:2rem;font-weight:700;letter-spacing:1px;">₹2Cr</div>
    </div>
    <div style="flex:1;background:#181818;border-radius:14px;padding:24px 0 18px 24px;display:flex;flex-direction:column;gap:8px;min-width:180px;">
      <div style="font-size:0.95rem;color:#aaa;">Avg Occupancy</div>
      <div style="font-size:2rem;font-weight:700;letter-spacing:1px;">12.4%</div>
    </div>
    <div style="flex:1;background:#181818;border-radius:14px;padding:24px 0 18px 24px;display:flex;flex-direction:column;gap:8px;min-width:180px;">
      <div style="font-size:0.95rem;color:#aaa;">Avg Ticket Price</div>
      <div style="font-size:2rem;font-weight:700;letter-spacing:1px;">₹125</div>
    </div>
  </div>
  <!-- Chart Grid -->
  <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:28px;">
    <div style="background:#181818;border-radius:14px;padding:24px; height: 400px; display: flex; flex-direction: column;">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;">
        <div id="netCollectionStateTitle" style="font-size:1rem;color:#fff;">Net Collection by State</div>
        <div id="netCollectionBackBtn" style="margin-left:16px;display:none;"></div>
      </div>
      <div style="flex:1; min-height:0;"><canvas id="netCollectionStateChart" style="height:100%!important;max-height:352px;"></canvas></div>
    </div>
    <div style="background:#181818;border-radius:14px;padding:24px; height: 400px; display: flex; flex-direction: column;">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;">
        <div id="avgOccupancyStateTitle" style="font-size:1rem;color:#fff;">Avg Occupancy by State</div>
        <div id="avgOccupancyBackBtn" style="margin-left:16px;display:none;"></div>
      </div>
      <div style="flex:1; min-height:0;"><canvas id="avgOccupancyStateChart" style="height:100%!important;max-height:352px;"></canvas></div>
    </div>
    <div style="background:#181818;border-radius:14px;padding:24px; height: 400px; display: flex; flex-direction: column;">
      <div style="font-size:1rem;color:#fff;margin-bottom:10px;">Top Cinemas by Net Collection</div>
      <div style="flex:1; min-height:0;"><canvas id="topCinemasChart" style="height:100%!important;max-height:352px;"></canvas></div>
    </div>
    <div style="background:#181818;border-radius:14px;padding:24px; height: 400px; display: flex; flex-direction: column;">
      <div style="font-size:1rem;color:#fff;margin-bottom:10px;">Day-wise Net Collection</div>
      <div style="flex:1; min-height:0;"><canvas id="daywiseNetCollectionChart" style="height:100%!important;max-height:352px;"></canvas></div>
    </div>
    <div style="background:#181818;border-radius:14px;padding:24px; height: 400px; display: flex; flex-direction: column;">
      <div style="font-size:1rem;color:#fff;margin-bottom:10px;">Exhibitor-wise Net Collection</div>
      <div style="flex:1; min-height:0;"><canvas id="exhibitorNetCollectionChart" style="height:100%!important;max-height:352px;"></canvas></div>
    </div>
    <div style="background:#181818;border-radius:14px;padding:24px; height: 400px; display: flex; flex-direction: column; align-items:center; justify-content:center;">
      <div style="font-size:1rem;color:#fff;margin-bottom:10px;">Net Collection by Time Slot</div>
      <div style="flex:1; min-height:0; display:flex; align-items:center; justify-content:center;"><canvas id="netCollectionTimeSlotChart" style="height:352px!important;width:352px!important;"></canvas></div>
    </div>
    <div style="background:#181818;border-radius:14px;padding:24px; height: 400px; display: flex; flex-direction: column;">
      <div style="font-size:1rem;color:#fff;margin-bottom:10px;">Exhibitor-wise Avg Occupancy</div>
      <div style="flex:1; min-height:0;"><canvas id="exhibitorAvgOccupancyChart" style="height:100%!important;max-height:352px;"></canvas></div>
    </div>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// Chart color palette for dark theme (global)
const chartPalette = ['#FFD700', '#E6D398', '#FF9900', '#FF5E00', '#00C2FF', '#8D6EFF', '#888888', '#4CAF50', '#FF3B30'];
let netCollectionStateChart;
let stateLevel = true;
let netCollectionDrillLevel = 'state';
let selectedState = null;
let selectedCity = null;
const stateData = {
  labels: ['Maharashtra', 'Delhi', 'Karnataka', 'Tamil Nadu', 'Telangana'],
  data: [5.2, 4.3, 4.1, 3.9, 3.3]
};
const stateCityData = {
  'Maharashtra': {
    labels: ['Mumbai', 'Pune', 'Nagpur', 'Nashik', 'Thane'],
    data: [2.1, 1.3, 0.8, 0.6, 0.4]
  },
  'Delhi': {
    labels: ['New Delhi', 'Rohini', 'Dwarka', 'Saket', 'Karol Bagh'],
    data: [1.5, 1.1, 0.9, 0.5, 0.3]
  },
  'Karnataka': {
    labels: ['Bengaluru', 'Mysuru', 'Mangaluru', 'Hubli', 'Belgaum'],
    data: [2.0, 0.8, 0.6, 0.4, 0.3]
  },
  'Tamil Nadu': {
    labels: ['Chennai', 'Coimbatore', 'Madurai', 'Salem', 'Tiruchirappalli'],
    data: [1.7, 0.7, 0.6, 0.5, 0.4]
  },
  'Telangana': {
    labels: ['Hyderabad', 'Warangal', 'Nizamabad', 'Karimnagar', 'Khammam'],
    data: [1.8, 0.6, 0.4, 0.3, 0.2]
  }
};
const cityAreaData = {
  'Mumbai': { labels: ['Andheri', 'Bandra', 'Borivali', 'Dadar', 'Juhu'], data: [0.7, 0.5, 0.4, 0.3, 0.2] },
  'Pune': { labels: ['Kothrud', 'Viman Nagar', 'Hinjewadi', 'Baner', 'Hadapsar'], data: [0.4, 0.3, 0.2, 0.2, 0.2] },
  'Nagpur': { labels: ['Dharampeth', 'Sitabuldi', 'Civil Lines', 'Sadar', 'Mahal'], data: [0.3, 0.2, 0.1, 0.1, 0.1] },
  'Nashik': { labels: ['College Road', 'Indira Nagar', 'Panchavati', 'Satpur', 'CIDCO'], data: [0.2, 0.1, 0.1, 0.1, 0.1] },
  'Thane': { labels: ['Ghodbunder', 'Vartak Nagar', 'Majiwada', 'Kopri', 'Naupada'], data: [0.2, 0.1, 0.1, 0.1, 0.1] },
  'New Delhi': { labels: ['Connaught Place', 'Chanakyapuri', 'Lajpat Nagar', 'Saket', 'Karol Bagh'], data: [0.5, 0.3, 0.2, 0.2, 0.1] },
  'Rohini': { labels: ['Sector 3', 'Sector 7', 'Sector 13', 'Sector 9', 'Sector 11'], data: [0.3, 0.2, 0.2, 0.2, 0.2] },
  'Dwarka': { labels: ['Sector 6', 'Sector 10', 'Sector 12', 'Sector 5', 'Sector 3'], data: [0.2, 0.2, 0.2, 0.2, 0.1] },
  'Saket': { labels: ['PVR Complex', 'Press Enclave', 'J Block', 'M Block', 'DDA Flats'], data: [0.2, 0.1, 0.1, 0.1, 0.1] },
  'Karol Bagh': { labels: ['Ajmal Khan', 'Bank Street', 'Beadonpura', 'Dev Nagar', 'Faiz Road'], data: [0.1, 0.1, 0.1, 0.1, 0.1] },
  // Add similar area data for other cities as needed
};
function updateNetCollectionBackBtn() {
  const btn = document.getElementById('netCollectionBackBtn');
  if (netCollectionDrillLevel === 'state') {
    btn.style.display = 'none';
  } else if (netCollectionDrillLevel === 'city') {
    btn.style.display = 'block';
    btn.innerHTML = '<button style="background:#222;color:#FFD600;border:none;padding:6px 16px;border-radius:6px;cursor:pointer;font-weight:600;" onclick="showStateLevel()">← Back to States</button>';
  } else if (netCollectionDrillLevel === 'area') {
    btn.style.display = 'block';
    btn.innerHTML = '<button style="background:#222;color:#FFD600;border:none;padding:6px 16px;border-radius:6px;cursor:pointer;font-weight:600;" onclick="showCityLevel(\'' + selectedState + '\')">← Back to Cities</button>';
  }
}

function renderNetCollectionChart(labels, data, title) {
  const ctx = document.getElementById('netCollectionStateChart').getContext('2d');
  if (netCollectionStateChart) netCollectionStateChart.destroy();
  netCollectionStateChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: labels,
      datasets: [{
        data: data,
        backgroundColor: '#FFD700',
        borderRadius: 8
      }]
    },
    options: {
      plugins: { legend: { display: false } },
      scales: {
        y: { beginAtZero: true, ticks: { color: '#aaa', callback: v => v + 'M' } },
        x: { ticks: { color: '#aaa' } }
      },
      responsive: true,
      maintainAspectRatio: false,
      onClick: (e, elements) => {
        if (netCollectionDrillLevel === 'state' && elements.length > 0) {
          const idx = elements[0].index;
          const state = labels[idx];
          if (stateCityData[state]) {
            selectedState = state;
            netCollectionDrillLevel = 'city';
            renderNetCollectionChart(stateCityData[state].labels, stateCityData[state].data, `Net Collection by Area (${state})`);
            updateNetCollectionBackBtn();
          }
        } else if (netCollectionDrillLevel === 'city' && elements.length > 0) {
          const idx = elements[0].index;
          const city = labels[idx];
          if (cityAreaData[city]) {
            selectedCity = city;
            netCollectionDrillLevel = 'area';
            renderNetCollectionChart(cityAreaData[city].labels, cityAreaData[city].data, `Net Collection by Sector in ${city}`);
            updateNetCollectionBackBtn();
          }
        }
      }
    }
  });
  document.getElementById('netCollectionStateTitle').textContent = title;
  updateNetCollectionBackBtn();
}

function showStateLevel() {
  netCollectionDrillLevel = 'state';
  selectedState = null;
  selectedCity = null;
  renderNetCollectionChart(stateData.labels, stateData.data, 'Net Collection by State');
  // updateNetCollectionBackBtn(); // now called inside renderNetCollectionChart
}
function showCityLevel(state) {
  netCollectionDrillLevel = 'city';
  selectedState = state;
  selectedCity = null;
  renderNetCollectionChart(stateCityData[state].labels, stateCityData[state].data, `Net Collection by Area (${state})`);
  // updateNetCollectionBackBtn();
}
function showAreaLevel(city) {
  netCollectionDrillLevel = 'area';
  selectedCity = city;
  renderNetCollectionChart(cityAreaData[city].labels, cityAreaData[city].data, `Net Collection by Sector in ${city}`);
  // updateNetCollectionBackBtn();
}
document.getElementById('netCollectionBackBtn').onclick = null; // Remove old onclick
document.addEventListener('DOMContentLoaded', function() {
  showStateLevel();
});
// Avg Occupancy by State
let avgOccupancyStateChart;
let occDrillLevel = 'state';
let occSelectedState = null;
let occSelectedCity = null;
const occStateData = {
  labels: ['Telangana', 'Tamil Nadu', 'Karnataka', 'Delhi', 'Maharashtra'],
  data: [19.8, 16.7, 14.2, 12.8, 11.3]
};
const occStateCityData = {
  'Telangana': {
    labels: ['Hyderabad', 'Warangal', 'Nizamabad', 'Karimnagar', 'Khammam'],
    data: [22, 18, 15, 13, 10]
  },
  'Tamil Nadu': {
    labels: ['Chennai', 'Coimbatore', 'Madurai', 'Salem', 'Tiruchirappalli'],
    data: [20, 17, 15, 13, 10]
  },
  'Karnataka': {
    labels: ['Bengaluru', 'Mysuru', 'Mangaluru', 'Hubli', 'Belgaum'],
    data: [18, 15, 13, 11, 9]
  },
  'Delhi': {
    labels: ['New Delhi', 'Rohini', 'Dwarka', 'Saket', 'Karol Bagh'],
    data: [14, 13, 12, 11, 10]
  },
  'Maharashtra': {
    labels: ['Mumbai', 'Pune', 'Nagpur', 'Nashik', 'Thane'],
    data: [13, 12, 11, 10, 9]
  }
};
const occCityAreaData = {
  'Hyderabad': { labels: ['Banjara Hills', 'Gachibowli', 'Kukatpally', 'Ameerpet', 'Secunderabad'], data: [24, 21, 19, 17, 15] },
  'Warangal': { labels: ['Hanamkonda', 'Kazipet', 'Subedari', 'Narsampet', 'Jangaon'], data: [19, 17, 15, 13, 12] },
  'Nizamabad': { labels: ['Bodhan', 'Armoor', 'Nizamabad Rural', 'Dichpally', 'Yellareddy'], data: [16, 14, 13, 12, 10] },
  'Karimnagar': { labels: ['Ramagundam', 'Jagtial', 'Korutla', 'Sircilla', 'Mancherial'], data: [15, 13, 12, 11, 10] },
  'Khammam': { labels: ['Wyra', 'Sathupalli', 'Kothagudem', 'Palwancha', 'Madhira'], data: [14, 13, 12, 11, 10] },
  'Chennai': { labels: ['T Nagar', 'Velachery', 'Anna Nagar', 'Adyar', 'Kodambakkam'], data: [22, 20, 18, 16, 15] },
  'Coimbatore': { labels: ['RS Puram', 'Gandhipuram', 'Peelamedu', 'Saibaba Colony', 'Singanallur'], data: [18, 17, 16, 15, 14] },
  'Madurai': { labels: ['KK Nagar', 'Anna Nagar', 'Tallakulam', 'Goripalayam', 'Simmakkal'], data: [17, 16, 15, 14, 13] },
  'Salem': { labels: ['Fairlands', 'Hasthampatti', 'Seelanaickenpatti', 'Ammapet', 'Suramangalam'], data: [16, 15, 14, 13, 12] },
  'Tiruchirappalli': { labels: ['Srirangam', 'Thillai Nagar', 'Cantonment', 'Woraiyur', 'Edamalaipatti'], data: [15, 14, 13, 12, 11] },
  'Bengaluru': { labels: ['Indiranagar', 'Koramangala', 'Whitefield', 'Jayanagar', 'Malleshwaram'], data: [20, 18, 17, 16, 15] },
  'Mysuru': { labels: ['VV Mohalla', 'Jayalakshmipuram', 'Saraswathipuram', 'Gokulam', 'Hebbal'], data: [17, 16, 15, 14, 13] },
  'Mangaluru': { labels: ['Kadri', 'Bejai', 'Kankanady', 'Pandeshwar', 'Surathkal'], data: [16, 15, 14, 13, 12] },
  'Hubli': { labels: ['Vidyanagar', 'Gokul Road', 'Keshwapur', 'Deshpande Nagar', 'Old Hubli'], data: [15, 14, 13, 12, 11] },
  'Belgaum': { labels: ['Tilakwadi', 'Shivaji Nagar', 'Sadashiv Nagar', 'Rani Chennamma Nagar', 'Hindwadi'], data: [14, 13, 12, 11, 10] },
  'New Delhi': { labels: ['Connaught Place', 'Chanakyapuri', 'Lajpat Nagar', 'Saket', 'Karol Bagh'], data: [16, 15, 14, 13, 12] },
  'Rohini': { labels: ['Sector 3', 'Sector 7', 'Sector 13', 'Sector 9', 'Sector 11'], data: [15, 14, 13, 12, 11] },
  'Dwarka': { labels: ['Sector 6', 'Sector 10', 'Sector 12', 'Sector 5', 'Sector 3'], data: [14, 13, 12, 11, 10] },
  'Saket': { labels: ['PVR Complex', 'Press Enclave', 'J Block', 'M Block', 'DDA Flats'], data: [13, 12, 11, 10, 9] },
  'Karol Bagh': { labels: ['Ajmal Khan', 'Bank Street', 'Beadonpura', 'Dev Nagar', 'Faiz Road'], data: [12, 11, 10, 9, 8] },
  'Mumbai': { labels: ['Andheri', 'Bandra', 'Borivali', 'Dadar', 'Juhu'], data: [15, 14, 13, 12, 11] },
  'Pune': { labels: ['Kothrud', 'Viman Nagar', 'Hinjewadi', 'Baner', 'Hadapsar'], data: [14, 13, 12, 11, 10] },
  'Nagpur': { labels: ['Dharampeth', 'Sitabuldi', 'Civil Lines', 'Sadar', 'Mahal'], data: [13, 12, 11, 10, 9] },
  'Nashik': { labels: ['College Road', 'Indira Nagar', 'Panchavati', 'Satpur', 'CIDCO'], data: [12, 11, 10, 9, 8] },
  'Thane': { labels: ['Ghodbunder', 'Vartak Nagar', 'Majiwada', 'Kopri', 'Naupada'], data: [11, 10, 9, 8, 7] }
};
function updateOccBackBtn() {
  const btn = document.getElementById('avgOccupancyBackBtn');
  if (occDrillLevel === 'state') {
    btn.style.display = 'none';
  } else if (occDrillLevel === 'city') {
    btn.style.display = 'block';
    btn.innerHTML = '<button style="background:#222;color:#FFD600;border:none;padding:6px 16px;border-radius:6px;cursor:pointer;font-weight:600;" onclick="showOccStateLevel()">← Back to States</button>';
  } else if (occDrillLevel === 'area') {
    btn.style.display = 'block';
    btn.innerHTML = '<button style="background:#222;color:#FFD600;border:none;padding:6px 16px;border-radius:6px;cursor:pointer;font-weight:600;" onclick="showOccCityLevel(\'' + occSelectedState + '\')">← Back to Cities</button>';
  }
}
function renderAvgOccupancyChart(labels, data, title) {
  const ctx = document.getElementById('avgOccupancyStateChart').getContext('2d');
  if (avgOccupancyStateChart) avgOccupancyStateChart.destroy();
  avgOccupancyStateChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: labels,
      datasets: [{
        data: data,
        backgroundColor: '#E6D398',
        borderRadius: 8
      }]
    },
    options: {
      plugins: { legend: { display: false } },
      scales: {
        y: { beginAtZero: true, ticks: { color: '#aaa', callback: v => v + '%' } },
        x: { ticks: { color: '#aaa' } }
      },
      responsive: true,
      maintainAspectRatio: false,
      onClick: (e, elements) => {
        if (occDrillLevel === 'state' && elements.length > 0) {
          const idx = elements[0].index;
          const state = labels[idx];
          if (occStateCityData[state]) {
            occSelectedState = state;
            occDrillLevel = 'city';
            renderAvgOccupancyChart(occStateCityData[state].labels, occStateCityData[state].data, `Avg Occupancy by City in ${state}`);
            updateOccBackBtn();
          }
        } else if (occDrillLevel === 'city' && elements.length > 0) {
          const idx = elements[0].index;
          const city = labels[idx];
          if (occCityAreaData[city]) {
            occSelectedCity = city;
            occDrillLevel = 'area';
            renderAvgOccupancyChart(occCityAreaData[city].labels, occCityAreaData[city].data, `Avg Occupancy by Area in ${city}`);
            updateOccBackBtn();
          }
        }
      }
    }
  });
  document.getElementById('avgOccupancyStateTitle').textContent = title;
  updateOccBackBtn();
}
function showOccStateLevel() {
  occDrillLevel = 'state';
  occSelectedState = null;
  occSelectedCity = null;
  renderAvgOccupancyChart(occStateData.labels, occStateData.data, 'Avg Occupancy by State');
}
function showOccCityLevel(state) {
  occDrillLevel = 'city';
  occSelectedState = state;
  occSelectedCity = null;
  renderAvgOccupancyChart(occStateCityData[state].labels, occStateCityData[state].data, `Avg Occupancy by City in ${state}`);
}
function showOccAreaLevel(city) {
  occDrillLevel = 'area';
  occSelectedCity = city;
  renderAvgOccupancyChart(occCityAreaData[city].labels, occCityAreaData[city].data, `Avg Occupancy by Area in ${city}`);
}
document.getElementById('avgOccupancyBackBtn').onclick = null;
document.addEventListener('DOMContentLoaded', function() {
  showOccStateLevel();
});
// Top Cinemas by Net Collection (horizontal bar)
new Chart(document.getElementById('topCinemasChart').getContext('2d'), {
  type: 'bar',
  data: {
    labels: ['PVR Phoenix', 'INOX City Center', 'Carnival Cinemas', 'Cinepolis Grand', 'Miraj Gold'],
    datasets: [{
      data: [1.9, 1.6, 1.1, 0.8, 0.6],
      backgroundColor: '#FFD700',
      borderRadius: 8
    }]
  },
  options: {indexAxis:'y',plugins:{legend:{display:false}},scales:{x:{beginAtZero:true,ticks:{color:'#aaa',callback:v=>v+'M'}},y:{ticks:{color:'#aaa'}}},responsive:true,maintainAspectRatio:false}
});
// Day-wise Net Collection (line)
new Chart(document.getElementById('daywiseNetCollectionChart').getContext('2d'), {
  type: 'line',
  data: {
    labels: Array.from({length:28},(_,i)=>'Day '+(i+1)),
    datasets: [{
      data: [2.8,2.1,1.7,1.5,1.3,1.1,1.0,0.95,0.9,0.85,0.8,0.75,0.7,0.65,0.6,0.55,0.5,0.45,0.4,0.35,0.3,0.28,0.26,0.24,0.22,0.2,0.18,0.16],
      borderColor: '#FFD700',
      backgroundColor: 'rgba(255,215,0,0.08)',
      borderWidth: 2,
      tension: 0.4,
      fill: true,
      pointRadius: 0
    }]
  },
  options: {plugins:{legend:{display:false}},scales:{y:{beginAtZero:true,ticks:{color:'#aaa',callback:v=>v+'M'}},x:{ticks:{color:'#aaa'}}},responsive:true,maintainAspectRatio:false}
});
// Exhibitor-wise Net Collection (bar)
new Chart(document.getElementById('exhibitorNetCollectionChart').getContext('2d'), {
  type: 'bar',
  data: {
    labels: ['PVR', 'INOX', 'Carnival', 'Miraj', 'Cinepolis'],
    datasets: [{
      data: [750000, 700000, 680000, 720000, 690000],
      backgroundColor: '#E6D398',
      borderRadius: 8
    }]
  },
  options: {plugins:{legend:{display:false}},scales:{y:{beginAtZero:true,ticks:{color:'#aaa',callback:v=>v/1000000+'M'}},x:{ticks:{color:'#aaa'}}},responsive:true,maintainAspectRatio:false}
});
// Net Collection by Time Slot (pie)
new Chart(document.getElementById('netCollectionTimeSlotChart').getContext('2d'), {
  type: 'pie',
  data: {
    labels: ['Matinee Show','First Show','Second Show','Noon Show','Special Shows'],
    datasets: [{
      data: [31.4, 12.9, 23.5, 29.3, 2.9],
      backgroundColor: ['#FFD700', '#E6D398', '#FF9900', '#FF5E00', '#00C2FF']
    }]
  },
  options: {plugins:{legend:{position:'bottom',align:'center',labels:{color:'#aaa',font:{size:14}}}},responsive:true,maintainAspectRatio:false}
});
// Exhibitor-wise Avg Occupancy (bar)
new Chart(document.getElementById('exhibitorAvgOccupancyChart').getContext('2d'), {
  type: 'bar',
  data: {
    labels: ['PVR', 'INOX', 'Carnival', 'Miraj', 'Cinepolis'],
    datasets: [{
      data: [17, 9, 19, 21, 15],
      backgroundColor: '#E6D398',
      borderRadius: 8
    }]
  },
  options: {plugins:{legend:{display:false}},scales:{y:{beginAtZero:true,max:36,ticks:{color:'#aaa',callback:v=>v+'%'}},x:{ticks:{color:'#aaa'}}},responsive:true,maintainAspectRatio:false}
});
</script>
</body>
</html>